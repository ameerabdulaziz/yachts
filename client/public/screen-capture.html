<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yachtak Screen Capture Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .capture-tool {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.2s;
        }
        .btn:hover { background: #1d4ed8; }
        .btn:disabled { background: #94a3b8; cursor: not-allowed; }
        .btn.danger { background: #dc2626; }
        .btn.danger:hover { background: #b91c1c; }
        .progress {
            margin: 20px 0;
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #2563eb;
        }
        .progress-bar {
            background: #e2e8f0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            background: #2563eb;
            height: 100%;
            transition: width 0.3s ease;
        }
        .log {
            height: 200px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            background: #fafafa;
        }
        .routes-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            margin: 15px 0;
        }
        .route-item {
            padding: 8px 12px;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .route-item:last-child { border-bottom: none; }
        .route-status {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }
        .status-pending { background: #f3f4f6; color: #374151; }
        .status-capturing { background: #dbeafe; color: #1d4ed8; }
        .status-success { background: #d1fae5; color: #047857; }
        .status-error { background: #fee2e2; color: #dc2626; }
        iframe {
            display: none;
        }
    </style>
</head>
<body>
    <div class="capture-tool">
        <div class="header">
            <h1>üì± Yachtak Screen Capture Tool</h1>
            <p>Comprehensive screenshot capture for all application screens</p>
        </div>

        <div class="controls">
            <button class="btn" onclick="startCapture()" id="startBtn">üöÄ Start Capture</button>
            <button class="btn" onclick="pauseCapture()" id="pauseBtn" disabled>‚è∏Ô∏è Pause</button>
            <button class="btn danger" onclick="stopCapture()" id="stopBtn" disabled>‚èπÔ∏è Stop</button>
            <button class="btn" onclick="downloadAll()" id="downloadBtn" disabled>üì¶ Download All</button>
        </div>

        <div class="progress" id="progressContainer" style="display: none;">
            <div id="progressText">Preparing capture...</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div id="progressStats">0 / 0 screens captured</div>
        </div>

        <div class="routes-list" id="routesList">
            <!-- Routes will be populated here -->
        </div>

        <div>
            <h3>üìã Capture Log</h3>
            <div class="log" id="captureLog"></div>
        </div>
    </div>

    <!-- Hidden iframe for capturing screens -->
    <iframe id="captureFrame" width="390" height="844"></iframe>

    <script>
        // Complete route manifest - all 38+ application screens
        const routeManifest = [
            // Authentication & Onboarding (01-04)
            { path: '/splash', filename: '01_auth_splash.png', name: 'Splash Screen', category: 'Authentication' },
            { path: '/login', filename: '02_auth_phone_login.png', name: 'Phone Login', category: 'Authentication' },
            { path: '/verify-otp', filename: '03_auth_otp_verification.png', name: 'OTP Verification', category: 'Authentication' },
            { path: '/account-setup', filename: '04_auth_account_setup.png', name: 'Account Setup', category: 'Authentication' },

            // Discovery & Home (10-12)
            { path: '/', filename: '10_discovery_ownership_home.png', name: 'Ownership Home', category: 'Discovery' },
            { path: '/ownership-opportunities', filename: '11_discovery_ownership_opportunities.png', name: 'Ownership Opportunities', category: 'Discovery' },
            { path: '/yacht-details/1', filename: '12_discovery_yacht_details.png', name: 'Yacht Details', category: 'Discovery' },

            // Charter & Fleet (15-16)
            { path: '/charter', filename: '15_charter_fleet_browser.png', name: 'Charter Fleet Browser', category: 'Charter' },

            // Booking System (20-23)
            { path: '/booking/1', filename: '20_booking_checkout.png', name: 'Booking Checkout', category: 'Booking' },
            { path: '/booking-confirmation', filename: '21_booking_confirmation.png', name: 'Booking Confirmation', category: 'Booking' },
            { path: '/my-bookings', filename: '22_bookings_my_bookings.png', name: 'My Bookings', category: 'Booking' },
            { path: '/reservation-detail/1', filename: '23_bookings_reservation_detail.png', name: 'Reservation Detail', category: 'Booking' },

            // Ownership Management (30-32)
            { path: '/ownership/1', filename: '30_ownership_detail.png', name: 'Yacht Ownership Detail', category: 'Ownership' },
            { path: '/ownership-inquiry/1', filename: '31_ownership_inquiry.png', name: 'Ownership Inquiry', category: 'Ownership' },
            { path: '/inquiry-thank-you', filename: '32_ownership_inquiry_thank_you.png', name: 'Inquiry Thank You', category: 'Ownership' },

            // Share Trading Marketplace (40-44)
            { path: '/share-marketplace', filename: '40_marketplace_share_marketplace.png', name: 'Share Marketplace', category: 'Marketplace' },
            { path: '/share-listing/1', filename: '41_marketplace_share_listing_detail.png', name: 'Share Listing Detail', category: 'Marketplace' },
            { path: '/list-share-for-sale', filename: '42_marketplace_list_share_for_sale.png', name: 'List Share for Sale', category: 'Marketplace' },
            { path: '/share-purchase-confirmation/1', filename: '43_marketplace_share_purchase_confirmation.png', name: 'Share Purchase Confirmation', category: 'Marketplace' },
            { path: '/share-trading', filename: '44_marketplace_share_trading.png', name: 'Share Trading', category: 'Marketplace' },

            // Owner Dashboard & Management (50-57)
            { path: '/owner-dashboard', filename: '50_owner_dashboard.png', name: 'Owner Dashboard', category: 'Owner Management' },
            { path: '/my-boats', filename: '51_owner_my_boats.png', name: 'My Boats', category: 'Owner Management' },
            { path: '/boat-management/1', filename: '52_owner_boat_management.png', name: 'Boat Management', category: 'Owner Management' },
            { path: '/add-boat-listing', filename: '53_owner_add_boat_listing.png', name: 'Add Boat Listing', category: 'Owner Management' },
            { path: '/boat-calendar/1', filename: '54_owner_boat_calendar.png', name: 'Boat Calendar', category: 'Owner Management' },
            { path: '/boat-ownership/1', filename: '55_owner_boat_ownership_management.png', name: 'Boat Ownership Management', category: 'Owner Management' },
            { path: '/booking-calendar/1', filename: '56_owner_booking_calendar.png', name: 'Booking Calendar', category: 'Owner Management' },
            { path: '/waitlist-management', filename: '57_owner_waitlist_management.png', name: 'Waitlist Management', category: 'Owner Management' },

            // Fuel Wallet System (60-61)
            { path: '/fuel-wallet', filename: '60_wallet_fuel_wallet.png', name: 'Fuel Wallet', category: 'Wallet' },
            { path: '/top-up', filename: '61_wallet_top_up.png', name: 'Top Up', category: 'Wallet' },

            // Communication & Messaging (70-71)
            { path: '/messages', filename: '70_messaging_center.png', name: 'Messaging Center', category: 'Communication' },
            { path: '/chat/1', filename: '71_chat_thread.png', name: 'Chat Thread', category: 'Communication' },

            // Profile & Settings (80-82)
            { path: '/profile', filename: '80_profile_user_profile.png', name: 'User Profile', category: 'Profile' },
            { path: '/edit-profile', filename: '81_profile_edit_profile.png', name: 'Edit Profile', category: 'Profile' },
            { path: '/settings', filename: '82_profile_settings.png', name: 'Settings', category: 'Profile' },

            // Notifications & Dashboard (90-99)
            { path: '/notifications', filename: '90_notifications.png', name: 'Notification Center', category: 'Notifications' },
            { path: '/dashboard', filename: '99_dashboard.png', name: 'Dashboard', category: 'Dashboard' },

            // Development & Utility (98-97)
            { path: '/dev-navigation', filename: '98_dev_navigation.png', name: 'Development Navigation', category: 'Development' }
        ];

        let captureState = {
            isCapturing: false,
            isPaused: false,
            currentIndex: 0,
            capturedScreens: {},
            totalScreens: routeManifest.length
        };

        function log(message) {
            const logDiv = document.getElementById('captureLog');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function updateProgress() {
            const captured = Object.keys(captureState.capturedScreens).length;
            const total = captureState.totalScreens;
            const percentage = (captured / total) * 100;
            
            document.getElementById('progressFill').style.width = `${percentage}%`;
            document.getElementById('progressStats').textContent = `${captured} / ${total} screens captured`;
            document.getElementById('progressText').textContent = 
                captureState.isCapturing ? `Capturing: ${routeManifest[captureState.currentIndex]?.name || 'Unknown'}` : 'Ready';
        }

        function updateRouteStatus(index, status) {
            const routeElement = document.querySelector(`[data-route-index="${index}"]`);
            if (routeElement) {
                routeElement.className = `route-status status-${status}`;
                routeElement.textContent = status.charAt(0).toUpperCase() + status.slice(1);
            }
        }

        function initializeRoutesList() {
            const routesList = document.getElementById('routesList');
            routesList.innerHTML = routeManifest.map((route, index) => `
                <div class="route-item">
                    <div>
                        <strong>${route.name}</strong>
                        <br><small style="color: #64748b;">${route.path}</small>
                    </div>
                    <span class="route-status status-pending" data-route-index="${index}">Pending</span>
                </div>
            `).join('');
        }

        async function captureScreen(route, index) {
            return new Promise((resolve) => {
                log(`üì∏ Capturing: ${route.name} (${route.path})`);
                updateRouteStatus(index, 'capturing');

                const iframe = document.getElementById('captureFrame');
                
                iframe.onload = async function() {
                    try {
                        // Wait for content to load
                        await new Promise(resolve => setTimeout(resolve, 3000));
                        
                        const canvas = await html2canvas(iframe.contentDocument.body, {
                            width: 390,
                            height: 844,
                            useCORS: true,
                            allowTaint: true,
                            scale: 2
                        });

                        canvas.toBlob((blob) => {
                            const url = URL.createObjectURL(blob);
                            captureState.capturedScreens[route.filename] = {
                                url: url,
                                blob: blob,
                                route: route,
                                timestamp: new Date().toISOString()
                            };

                            log(`‚úÖ Captured: ${route.filename}`);
                            updateRouteStatus(index, 'success');
                            updateProgress();
                            resolve(true);
                        }, 'image/png');

                    } catch (error) {
                        log(`‚ùå Failed: ${route.name} - ${error.message}`);
                        updateRouteStatus(index, 'error');
                        resolve(false);
                    }
                };

                iframe.onerror = function() {
                    log(`‚ùå Failed to load: ${route.path}`);
                    updateRouteStatus(index, 'error');
                    resolve(false);
                };

                iframe.src = route.path;
            });
        }

        async function startCapture() {
            captureState.isCapturing = true;
            captureState.isPaused = false;
            captureState.currentIndex = 0;

            document.getElementById('startBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = false;
            document.getElementById('stopBtn').disabled = false;
            document.getElementById('progressContainer').style.display = 'block';

            log(`üöÄ Starting capture of ${captureState.totalScreens} screens...`);

            for (let i = 0; i < routeManifest.length; i++) {
                if (!captureState.isCapturing) break;
                
                while (captureState.isPaused) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                }

                captureState.currentIndex = i;
                await captureScreen(routeManifest[i], i);
                
                // Small delay between captures
                await new Promise(resolve => setTimeout(resolve, 1000));
            }

            if (captureState.isCapturing) {
                log(`üéâ Capture complete! ${Object.keys(captureState.capturedScreens).length} screens captured.`);
                document.getElementById('downloadBtn').disabled = false;
            }

            stopCapture();
        }

        function pauseCapture() {
            captureState.isPaused = !captureState.isPaused;
            const pauseBtn = document.getElementById('pauseBtn');
            pauseBtn.textContent = captureState.isPaused ? '‚ñ∂Ô∏è Resume' : '‚è∏Ô∏è Pause';
            log(captureState.isPaused ? '‚è∏Ô∏è Capture paused' : '‚ñ∂Ô∏è Capture resumed');
        }

        function stopCapture() {
            captureState.isCapturing = false;
            captureState.isPaused = false;

            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('pauseBtn').textContent = '‚è∏Ô∏è Pause';

            log('‚èπÔ∏è Capture stopped');
        }

        function downloadAll() {
            log('üì¶ Preparing download package...');
            
            // Create and download individual files
            Object.values(captureState.capturedScreens).forEach(screen => {
                const link = document.createElement('a');
                link.href = screen.url;
                link.download = screen.route.filename;
                link.click();
            });

            // Create manifest
            const manifest = {
                captureDate: new Date().toISOString(),
                totalScreens: captureState.totalScreens,
                capturedScreens: Object.keys(captureState.capturedScreens).length,
                screens: Object.values(captureState.capturedScreens).map(screen => ({
                    filename: screen.route.filename,
                    name: screen.route.name,
                    path: screen.route.path,
                    category: screen.route.category,
                    timestamp: screen.timestamp
                }))
            };

            const manifestBlob = new Blob([JSON.stringify(manifest, null, 2)], { type: 'application/json' });
            const manifestUrl = URL.createObjectURL(manifestBlob);
            const manifestLink = document.createElement('a');
            manifestLink.href = manifestUrl;
            manifestLink.download = 'manifest.json';
            manifestLink.click();

            log(`üì• Downloaded ${Object.keys(captureState.capturedScreens).length} screenshots + manifest.json`);
        }

        // Initialize the tool
        document.addEventListener('DOMContentLoaded', function() {
            initializeRoutesList();
            updateProgress();
            log('üîß Screen capture tool initialized');
            log(`üìã ${captureState.totalScreens} screens ready for capture`);
        });
    </script>
</body>
</html>